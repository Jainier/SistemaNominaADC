@page "/mantenimientos/grupos"
@attribute [Authorize(Policy = "AdminOnly")]

@using SistemaNominaADC.Entidades

<h3>Mantenimiento de Grupos de Estados</h3>

@if (mostrarFormulario)
{
    <FormularioMantenimiento Titulo="@tituloFormulario" Modelo="grupoActual" OnValidSubmit="Guardar" OnCancelar="Cancelar"
                             OnEliminar="Desactivar" MostrarEliminar="@(grupoActual.IdGrupoEstado > 0)">
        <EditorTemplate Context="grupo">
            <div class="mb-3">
                <label class="form-label">Nombre del Grupo</label>
                <InputText class="form-control" @bind-Value="grupo.Nombre" placeholder="Ej: ESTANDAR, RRHH, NOMINA" />
                <ValidationMessage For="@(() => grupo.Nombre)" />
            </div>
            <div class="mb-3">
                <label class="form-label">Descripción</label>
                <InputTextArea class="form-control" @bind-Value="grupo.Descripcion" />
                <ValidationMessage For="@(() => grupo.Descripcion)" />
            </div>
            <div class="form-check mb-3">
                <InputCheckbox class="form-check-input" id="chkGrupoActivo" @bind-Value="grupo.Activo" />
                <label class="form-check-label" for="chkGrupoActivo">Activo</label>
            </div>
        </EditorTemplate>
    </FormularioMantenimiento>
}
else
{
    <div class="mb-3">
        <button class="btn btn-primary" @onclick="Crear">
            <i class="bi bi-plus-circle"></i> Nuevo Grupo
        </button>
    </div>

    @if (listaGrupos == null)
    {
        <div class="alert alert-info">Cargando grupos...</div>
    }
    else
    {
    <TablaMantenimiento TItem="GrupoEstado" Items="listaGrupos" OnRowClick="Editar">

        <ColumnsTemplate>

                <RadzenDataGridColumn TItem="GrupoEstado"
                                    Property="IdGrupoEstado"
                                    Title="ID"
                                    Width="80px" />

                <RadzenDataGridColumn TItem="GrupoEstado"
                                    Property="Nombre"
                                    Title="Nombre" />

                <RadzenDataGridColumn TItem="GrupoEstado"
                                      Property="Descripcion"
                                    Title="Descripcion">
            </RadzenDataGridColumn>

                <RadzenDataGridColumn TItem="GrupoEstado"
                                      Property="Activo"
                                      Title="Estado">
                    <Template Context="item">
                        @(item.Activo ? "Activo" : "Inactivo")
                    </Template>
                </RadzenDataGridColumn>

        </ColumnsTemplate>
    </TablaMantenimiento>
    }
}
